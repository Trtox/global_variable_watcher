<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gwatch: Debugger Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">gwatch<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Global variable watcher with hardware breakpoints</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classDebugger-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Debugger Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classDebugger.html" title="The Debugger class runs a child process under ptrace and sets a hardware watchpoint on a specified gl...">Debugger</a> class runs a child process under ptrace and sets a hardware watchpoint on a specified global variable. It logs reads and writes to the variable in the following format:  
 <a href="classDebugger.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4cd7d6a0ffb861314798a237b2ac2b53" id="r_a4cd7d6a0ffb861314798a237b2ac2b53"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a4cd7d6a0ffb861314798a237b2ac2b53">Debugger</a> (std::string <a class="el" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>, std::string <a class="el" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a>, uintptr_t <a class="el" href="classDebugger.html#ad83c26bb3aec8a3feffb8cd5c7561020">symbolOffset</a>, size_t <a class="el" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>, char **<a class="el" href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">execArgs</a>)</td></tr>
<tr class="memdesc:a4cd7d6a0ffb861314798a237b2ac2b53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classDebugger.html" title="The Debugger class runs a child process under ptrace and sets a hardware watchpoint on a specified gl...">Debugger</a> for the given target program and variable.  <br /></td></tr>
<tr class="separator:a4cd7d6a0ffb861314798a237b2ac2b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678a867ba69bb710f2ed2e2575b58a6c" id="r_a678a867ba69bb710f2ed2e2575b58a6c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a678a867ba69bb710f2ed2e2575b58a6c">getProgramPath</a> () const</td></tr>
<tr class="memdesc:a678a867ba69bb710f2ed2e2575b58a6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the path of the target program.  <br /></td></tr>
<tr class="separator:a678a867ba69bb710f2ed2e2575b58a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c4e70c50a68c70b56061036f792c31" id="r_a81c4e70c50a68c70b56061036f792c31"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a81c4e70c50a68c70b56061036f792c31">getVarName</a> () const</td></tr>
<tr class="memdesc:a81c4e70c50a68c70b56061036f792c31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the name of the watched variable.  <br /></td></tr>
<tr class="separator:a81c4e70c50a68c70b56061036f792c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c548a31aeb08c0fc4a8dbabe6bc132c" id="r_a5c548a31aeb08c0fc4a8dbabe6bc132c"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a5c548a31aeb08c0fc4a8dbabe6bc132c">getSymbolOffset</a> () const</td></tr>
<tr class="memdesc:a5c548a31aeb08c0fc4a8dbabe6bc132c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the ELF symbol offset of the watched variable.  <br /></td></tr>
<tr class="separator:a5c548a31aeb08c0fc4a8dbabe6bc132c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a2970d958cb982a294cc10f5f34b430" id="r_a7a2970d958cb982a294cc10f5f34b430"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a7a2970d958cb982a294cc10f5f34b430">getVarSize</a> () const</td></tr>
<tr class="memdesc:a7a2970d958cb982a294cc10f5f34b430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the size in bytes of the watched variable.  <br /></td></tr>
<tr class="separator:a7a2970d958cb982a294cc10f5f34b430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb68979aeda450247b147fc2d3cce33" id="r_a0fb68979aeda450247b147fc2d3cce33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a0fb68979aeda450247b147fc2d3cce33">run</a> () const</td></tr>
<tr class="memdesc:a0fb68979aeda450247b147fc2d3cce33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forks and execs the target process, sets the hardware watchpoint, and monitors the variable in the child process.  <br /></td></tr>
<tr class="separator:a0fb68979aeda450247b147fc2d3cce33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a944ac1668f45b26a0da57b57ec159e78" id="r_a944ac1668f45b26a0da57b57ec159e78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a944ac1668f45b26a0da57b57ec159e78">watchVariable</a> (pid_t pid, uintptr_t runtimeAddress) const</td></tr>
<tr class="memdesc:a944ac1668f45b26a0da57b57ec159e78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop that applies the hardware watchpoint and logs variable accesses.  <br /></td></tr>
<tr class="separator:a944ac1668f45b26a0da57b57ec159e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d0423cddbb4b630749e6b13c4c1ed5" id="r_ac7d0423cddbb4b630749e6b13c4c1ed5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#ac7d0423cddbb4b630749e6b13c4c1ed5">setHardwareWatchpoint</a> (pid_t pid, uintptr_t runtimeAddress) const</td></tr>
<tr class="memdesc:ac7d0423cddbb4b630749e6b13c4c1ed5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Installs a hardware watchpoint using debug registers DR0–DR7.  <br /></td></tr>
<tr class="separator:ac7d0423cddbb4b630749e6b13c4c1ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a91d31ec968daa2d5c298b98a0f242559" id="r_a91d31ec968daa2d5c298b98a0f242559"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a></td></tr>
<tr class="memdesc:a91d31ec968daa2d5c298b98a0f242559"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path to the target executable.  <br /></td></tr>
<tr class="separator:a91d31ec968daa2d5c298b98a0f242559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58b15d3b221c0d3abd9ec8fc60f466d" id="r_ab58b15d3b221c0d3abd9ec8fc60f466d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a></td></tr>
<tr class="memdesc:ab58b15d3b221c0d3abd9ec8fc60f466d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the variable to watch.  <br /></td></tr>
<tr class="separator:ab58b15d3b221c0d3abd9ec8fc60f466d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83c26bb3aec8a3feffb8cd5c7561020" id="r_ad83c26bb3aec8a3feffb8cd5c7561020"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#ad83c26bb3aec8a3feffb8cd5c7561020">symbolOffset</a></td></tr>
<tr class="memdesc:ad83c26bb3aec8a3feffb8cd5c7561020"><td class="mdescLeft">&#160;</td><td class="mdescRight">ELF symbol offset.  <br /></td></tr>
<tr class="separator:ad83c26bb3aec8a3feffb8cd5c7561020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab84d2d21b212acbc00e644760140f4b" id="r_aab84d2d21b212acbc00e644760140f4b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a></td></tr>
<tr class="memdesc:aab84d2d21b212acbc00e644760140f4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable size in bytes.  <br /></td></tr>
<tr class="separator:aab84d2d21b212acbc00e644760140f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a5780226919af2ff430898ad95aabf9" id="r_a5a5780226919af2ff430898ad95aabf9"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">execArgs</a></td></tr>
<tr class="memdesc:a5a5780226919af2ff430898ad95aabf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optional exec arguments.  <br /></td></tr>
<tr class="separator:a5a5780226919af2ff430898ad95aabf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classDebugger.html" title="The Debugger class runs a child process under ptrace and sets a hardware watchpoint on a specified gl...">Debugger</a> class runs a child process under ptrace and sets a hardware watchpoint on a specified global variable. It logs reads and writes to the variable in the following format: </p>
<p>Example output: &lt;symbol&gt; write &lt;old&gt; -&gt; &lt;new&gt; &lt;symbol&gt; read </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00015">15</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4cd7d6a0ffb861314798a237b2ac2b53" name="a4cd7d6a0ffb861314798a237b2ac2b53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cd7d6a0ffb861314798a237b2ac2b53">&#9670;&#160;</a></span>Debugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Debugger::Debugger </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>programPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>varName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>symbolOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>varSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>execArgs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="classDebugger.html" title="The Debugger class runs a child process under ptrace and sets a hardware watchpoint on a specified gl...">Debugger</a> for the given target program and variable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">programPath</td><td>Path to the target executable. </td></tr>
    <tr><td class="paramname">varName</td><td>Name of the global variable to watch (for logging purposes). </td></tr>
    <tr><td class="paramname">symbolOffset</td><td>Offset of the symbol from the ELF symbol table (resolved at runtime). </td></tr>
    <tr><td class="paramname">varSize</td><td>Size of the variable in bytes (4 or 8). </td></tr>
    <tr><td class="paramname">execArgs</td><td>Optional argv array to pass to execv in the child process. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="debugger_8cpp_source.html#l00033">33</a> of file <a class="el" href="debugger_8cpp_source.html">debugger.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>    : <a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>(std::move(<a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>)),</div>
<div class="line"><span class="lineno">   39</span>      <a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a>(std::move(<a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a>)),</div>
<div class="line"><span class="lineno">   40</span>      <a class="code hl_variable" href="classDebugger.html#ad83c26bb3aec8a3feffb8cd5c7561020">symbolOffset</a>(varAddress),</div>
<div class="line"><span class="lineno">   41</span>      <a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>(<a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>),</div>
<div class="line"><span class="lineno">   42</span>      <a class="code hl_variable" href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">execArgs</a>(<a class="code hl_variable" href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">execArgs</a>) {}</div>
<div class="ttc" id="aclassDebugger_html_a5a5780226919af2ff430898ad95aabf9"><div class="ttname"><a href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">Debugger::execArgs</a></div><div class="ttdeci">char ** execArgs</div><div class="ttdoc">Optional exec arguments.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8hpp_source.html#l00071">debugger.hpp:71</a></div></div>
<div class="ttc" id="aclassDebugger_html_a91d31ec968daa2d5c298b98a0f242559"><div class="ttname"><a href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">Debugger::programPath</a></div><div class="ttdeci">std::string programPath</div><div class="ttdoc">Path to the target executable.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8hpp_source.html#l00067">debugger.hpp:67</a></div></div>
<div class="ttc" id="aclassDebugger_html_aab84d2d21b212acbc00e644760140f4b"><div class="ttname"><a href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">Debugger::varSize</a></div><div class="ttdeci">size_t varSize</div><div class="ttdoc">Variable size in bytes.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8hpp_source.html#l00070">debugger.hpp:70</a></div></div>
<div class="ttc" id="aclassDebugger_html_ab58b15d3b221c0d3abd9ec8fc60f466d"><div class="ttname"><a href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">Debugger::varName</a></div><div class="ttdeci">std::string varName</div><div class="ttdoc">Name of the variable to watch.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8hpp_source.html#l00068">debugger.hpp:68</a></div></div>
<div class="ttc" id="aclassDebugger_html_ad83c26bb3aec8a3feffb8cd5c7561020"><div class="ttname"><a href="classDebugger.html#ad83c26bb3aec8a3feffb8cd5c7561020">Debugger::symbolOffset</a></div><div class="ttdeci">uintptr_t symbolOffset</div><div class="ttdoc">ELF symbol offset.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8hpp_source.html#l00069">debugger.hpp:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a678a867ba69bb710f2ed2e2575b58a6c" name="a678a867ba69bb710f2ed2e2575b58a6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a678a867ba69bb710f2ed2e2575b58a6c">&#9670;&#160;</a></span>getProgramPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Debugger::getProgramPath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the path of the target program. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00033">33</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c548a31aeb08c0fc4a8dbabe6bc132c" name="a5c548a31aeb08c0fc4a8dbabe6bc132c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c548a31aeb08c0fc4a8dbabe6bc132c">&#9670;&#160;</a></span>getSymbolOffset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t Debugger::getSymbolOffset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the ELF symbol offset of the watched variable. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00039">39</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   39</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classDebugger.html#ad83c26bb3aec8a3feffb8cd5c7561020">symbolOffset</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81c4e70c50a68c70b56061036f792c31" name="a81c4e70c50a68c70b56061036f792c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81c4e70c50a68c70b56061036f792c31">&#9670;&#160;</a></span>getVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Debugger::getVarName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the name of the watched variable. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00036">36</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a2970d958cb982a294cc10f5f34b430" name="a7a2970d958cb982a294cc10f5f34b430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a2970d958cb982a294cc10f5f34b430">&#9670;&#160;</a></span>getVarSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Debugger::getVarSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the size in bytes of the watched variable. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00042">42</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   42</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0fb68979aeda450247b147fc2d3cce33" name="a0fb68979aeda450247b147fc2d3cce33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fb68979aeda450247b147fc2d3cce33">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Debugger::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forks and execs the target process, sets the hardware watchpoint, and monitors the variable in the child process. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8cpp_source.html#l00044">44</a> of file <a class="el" href="debugger_8cpp_source.html">debugger.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   44</span>                         {</div>
<div class="line"><span class="lineno">   45</span>    pid_t pid = fork();</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">if</span> (pid == -1) {</div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">throw</span> std::runtime_error(std::string(<span class="stringliteral">&quot;fork() failed: &quot;</span>) + std::strerror(errno));</div>
<div class="line"><span class="lineno">   48</span>    }</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">if</span> (pid == 0) {</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">if</span> (ptrace(PTRACE_TRACEME, 0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>) == -1) {</div>
<div class="line"><span class="lineno">   52</span>            perror(<span class="stringliteral">&quot;ptrace(TRACEME)&quot;</span>);</div>
<div class="line"><span class="lineno">   53</span>            _exit(1);</div>
<div class="line"><span class="lineno">   54</span>        }</div>
<div class="line"><span class="lineno">   55</span>        raise(SIGSTOP);</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">execArgs</a>) {</div>
<div class="line"><span class="lineno">   58</span>            execvp(<a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>.c_str(), <a class="code hl_variable" href="classDebugger.html#a5a5780226919af2ff430898ad95aabf9">execArgs</a>);</div>
<div class="line"><span class="lineno">   59</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   60</span>            <span class="keywordtype">char</span>* defaultArgs[] = { <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>.c_str()), <span class="keyword">nullptr</span> };</div>
<div class="line"><span class="lineno">   61</span>            execvp(<a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>.c_str(), defaultArgs);</div>
<div class="line"><span class="lineno">   62</span>        }</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>        perror(<span class="stringliteral">&quot;exec failed&quot;</span>);</div>
<div class="line"><span class="lineno">   65</span>        _exit(1);</div>
<div class="line"><span class="lineno">   66</span>    }</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">if</span> (waitpid(pid, &amp;status, 0) == -1) {</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">throw</span> std::runtime_error(std::string(<span class="stringliteral">&quot;waitpid failed: &quot;</span>) + std::strerror(errno));</div>
<div class="line"><span class="lineno">   71</span>    }</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span> (!WIFSTOPPED(status)) {</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Child did not stop as expected after exec/raise(SIGSTOP)&quot;</span>);</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    std::string absPath = <a class="code hl_function" href="memory__utils_8cpp.html#a7fbee27e6758dc2b1c867d3a0f86ef3a">getAbsolutePath</a>(<a class="code hl_variable" href="classDebugger.html#a91d31ec968daa2d5c298b98a0f242559">programPath</a>);</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_CONT, pid, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ptrace(PTRACE_CONT) failed after initial stop&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>    usleep(10000);</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    uintptr_t base = <a class="code hl_function" href="memory__utils_8cpp.html#a388c48cfc8c3f488d0a858205907b853">getBaseAddress</a>(pid, absPath);</div>
<div class="line"><span class="lineno">   82</span>    uintptr_t runtimeAddr = base + <a class="code hl_variable" href="classDebugger.html#ad83c26bb3aec8a3feffb8cd5c7561020">symbolOffset</a>;</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;Runtime variable address: 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; runtimeAddr &lt;&lt; std::dec</div>
<div class="line"><span class="lineno">   85</span>              &lt;&lt; <span class="stringliteral">&quot; (process &quot;</span> &lt;&lt; pid &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <a class="code hl_function" href="classDebugger.html#a944ac1668f45b26a0da57b57ec159e78">watchVariable</a>(pid, runtimeAddr);</div>
<div class="line"><span class="lineno">   88</span>}</div>
<div class="ttc" id="aclassDebugger_html_a944ac1668f45b26a0da57b57ec159e78"><div class="ttname"><a href="classDebugger.html#a944ac1668f45b26a0da57b57ec159e78">Debugger::watchVariable</a></div><div class="ttdeci">void watchVariable(pid_t pid, uintptr_t runtimeAddress) const</div><div class="ttdoc">Main loop that applies the hardware watchpoint and logs variable accesses.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8cpp_source.html#l00116">debugger.cpp:116</a></div></div>
<div class="ttc" id="adebugger_8cpp_html_a026bafbd79531068f563be4582a62a04"><div class="ttname"><a href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a></div><div class="ttdeci">static void ptraceChecked(int request, const pid_t &amp;pid, void *addr, void *data, const char *errMsg)</div><div class="ttdef"><b>Definition</b> <a href="debugger_8cpp_source.html#l00016">debugger.cpp:16</a></div></div>
<div class="ttc" id="amemory__utils_8cpp_html_a388c48cfc8c3f488d0a858205907b853"><div class="ttname"><a href="memory__utils_8cpp.html#a388c48cfc8c3f488d0a858205907b853">getBaseAddress</a></div><div class="ttdeci">uintptr_t getBaseAddress(pid_t pid, const std::string &amp;programPath)</div><div class="ttdoc">Retrieves the base address of a loaded executable in a process.</div><div class="ttdef"><b>Definition</b> <a href="memory__utils_8cpp_source.html#l00013">memory_utils.cpp:13</a></div></div>
<div class="ttc" id="amemory__utils_8cpp_html_a7fbee27e6758dc2b1c867d3a0f86ef3a"><div class="ttname"><a href="memory__utils_8cpp.html#a7fbee27e6758dc2b1c867d3a0f86ef3a">getAbsolutePath</a></div><div class="ttdeci">std::string getAbsolutePath(const std::string &amp;path)</div><div class="ttdoc">Resolves an absolute path for a given file or directory.</div><div class="ttdef"><b>Definition</b> <a href="memory__utils_8cpp_source.html#l00046">memory_utils.cpp:46</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classDebugger_a0fb68979aeda450247b147fc2d3cce33_cgraph.png" border="0" usemap="#aclassDebugger_a0fb68979aeda450247b147fc2d3cce33_cgraph" alt=""/></div>
<map name="aclassDebugger_a0fb68979aeda450247b147fc2d3cce33_cgraph" id="aclassDebugger_a0fb68979aeda450247b147fc2d3cce33_cgraph">
<area shape="rect" title="Forks and execs the target process, sets the hardware watchpoint, and monitors the variable in the ch..." alt="" coords="5,80,132,105"/>
<area shape="rect" href="memory__utils_8cpp.html#a7fbee27e6758dc2b1c867d3a0f86ef3a" title="Resolves an absolute path for a given file or directory." alt="" coords="212,5,355,31"/>
<area shape="poly" title=" " alt="" coords="93,78,133,58,179,39,205,32,206,37,181,45,135,63,95,82"/>
<area shape="rect" href="memory__utils_8cpp.html#a388c48cfc8c3f488d0a858205907b853" title="Retrieves the base address of a loaded executable in a process." alt="" coords="216,55,351,80"/>
<area shape="poly" title=" " alt="" coords="132,83,202,74,203,79,133,88"/>
<area shape="rect" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04" title=" " alt="" coords="753,181,880,207"/>
<area shape="poly" title=" " alt="" coords="133,96,384,125,706,170,741,176,740,181,705,175,383,131,132,102"/>
<area shape="rect" href="classDebugger.html#a944ac1668f45b26a0da57b57ec159e78" title="Main loop that applies the hardware watchpoint and logs variable accesses." alt="" coords="180,207,387,232"/>
<area shape="poly" title=" " alt="" coords="93,103,250,197,248,202,90,108"/>
<area shape="poly" title=" " alt="" coords="345,204,434,191,598,185,740,188,740,193,598,190,435,197,346,209"/>
<area shape="rect" href="debugger_8cpp.html#a508830d991569eaf3d8f36366ad68092" title=" " alt="" coords="495,207,645,232"/>
<area shape="poly" title=" " alt="" coords="387,217,481,217,481,222,387,222"/>
<area shape="rect" href="memory__utils_8cpp.html#a23d8272a733098323a9e47d6cc07c37d" title="Reads memory from a target process at a specific address." alt="" coords="491,256,649,281"/>
<area shape="poly" title=" " alt="" coords="358,229,483,251,482,256,357,235"/>
<area shape="rect" href="classDebugger.html#ac7d0423cddbb4b630749e6b13c4c1ed5" title="Installs a hardware watchpoint using debug registers DR0–DR7." alt="" coords="435,305,705,331"/>
<area shape="poly" title=" " alt="" coords="307,230,364,261,436,291,465,300,464,305,434,297,362,266,304,235"/>
<area shape="poly" title=" " alt="" coords="646,209,739,199,740,204,646,214"/>
<area shape="poly" title=" " alt="" coords="675,303,704,292,731,275,756,255,795,215,799,219,759,259,734,280,707,296,677,308"/>
<area shape="rect" href="debugger_8cpp.html#a66d4e2440757917d3870682ce5495082" title=" " alt="" coords="761,305,872,331"/>
<area shape="poly" title=" " alt="" coords="705,315,748,315,748,321,705,321"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classDebugger_a0fb68979aeda450247b147fc2d3cce33_icgraph.png" border="0" usemap="#aclassDebugger_a0fb68979aeda450247b147fc2d3cce33_icgraph" alt=""/></div>
<map name="aclassDebugger_a0fb68979aeda450247b147fc2d3cce33_icgraph" id="aclassDebugger_a0fb68979aeda450247b147fc2d3cce33_icgraph">
<area shape="rect" title="Forks and execs the target process, sets the hardware watchpoint, and monitors the variable in the ch..." alt="" coords="108,5,235,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="95,21,60,21,60,15,95,15"/>
</map>
</div>

</div>
</div>
<a id="ac7d0423cddbb4b630749e6b13c4c1ed5" name="ac7d0423cddbb4b630749e6b13c4c1ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d0423cddbb4b630749e6b13c4c1ed5">&#9670;&#160;</a></span>setHardwareWatchpoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Debugger::setHardwareWatchpoint </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>runtimeAddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Installs a hardware watchpoint using debug registers DR0–DR7. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>PID of the traced child process. </td></tr>
    <tr><td class="paramname">runtimeAddress</td><td>Runtime memory address of the variable to watch. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="debugger_8cpp_source.html#l00090">90</a> of file <a class="el" href="debugger_8cpp_source.html">debugger.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>                                                                           {</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_POKEUSER, pid,</div>
<div class="line"><span class="lineno">   92</span>                  <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(offsetof(user, u_debugreg[0])),</div>
<div class="line"><span class="lineno">   93</span>                  <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(runtimeAddr),</div>
<div class="line"><span class="lineno">   94</span>                  <span class="stringliteral">&quot;Failed to set DR0&quot;</span>);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    <span class="keyword">constexpr</span> <span class="keywordtype">long</span> ENABLE_LOCAL_DR0 = 1 &lt;&lt; 0;</div>
<div class="line"><span class="lineno">   97</span>    <span class="keyword">constexpr</span> <span class="keywordtype">long</span> RW_READWRITE = 0b11;</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordtype">long</span> len_code = <a class="code hl_function" href="debugger_8cpp.html#a66d4e2440757917d3870682ce5495082">dr_len_code</a>(<a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>);</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> (len_code &lt; 0) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Unsupported variable size for watchpoint&quot;</span>);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordtype">long</span> dr7 = ENABLE_LOCAL_DR0 | (RW_READWRITE &lt;&lt; 16) | (len_code &lt;&lt; 18);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_POKEUSER, pid,</div>
<div class="line"><span class="lineno">  104</span>                  <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(offsetof(user, u_debugreg[7])),</div>
<div class="line"><span class="lineno">  105</span>                  <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(dr7),</div>
<div class="line"><span class="lineno">  106</span>                  <span class="stringliteral">&quot;Failed to write DR7&quot;</span>);</div>
<div class="line"><span class="lineno">  107</span>}</div>
<div class="ttc" id="adebugger_8cpp_html_a66d4e2440757917d3870682ce5495082"><div class="ttname"><a href="debugger_8cpp.html#a66d4e2440757917d3870682ce5495082">dr_len_code</a></div><div class="ttdeci">static long dr_len_code(const size_t &amp;size)</div><div class="ttdef"><b>Definition</b> <a href="debugger_8cpp_source.html#l00023">debugger.cpp:23</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_cgraph.png" border="0" usemap="#aclassDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_cgraph" alt=""/></div>
<map name="aclassDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_cgraph" id="aclassDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_cgraph">
<area shape="rect" title="Installs a hardware watchpoint using debug registers DR0–DR7." alt="" coords="5,31,276,56"/>
<area shape="rect" href="debugger_8cpp.html#a66d4e2440757917d3870682ce5495082" title=" " alt="" coords="332,5,443,31"/>
<area shape="poly" title=" " alt="" coords="264,28,318,22,318,28,265,33"/>
<area shape="rect" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04" title=" " alt="" coords="324,55,451,80"/>
<area shape="poly" title=" " alt="" coords="271,53,310,57,310,63,271,59"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_icgraph.png" border="0" usemap="#aclassDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_icgraph" alt=""/></div>
<map name="aclassDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_icgraph" id="aclassDebugger_ac7d0423cddbb4b630749e6b13c4c1ed5_icgraph">
<area shape="rect" title="Installs a hardware watchpoint using debug registers DR0–DR7." alt="" coords="537,5,808,31"/>
<area shape="rect" href="classDebugger.html#a944ac1668f45b26a0da57b57ec159e78" title="Main loop that applies the hardware watchpoint and logs variable accesses." alt="" coords="283,5,489,31"/>
<area shape="poly" title=" " alt="" coords="524,21,489,21,489,15,524,15"/>
<area shape="rect" href="classDebugger.html#a0fb68979aeda450247b147fc2d3cce33" title="Forks and execs the target process, sets the hardware watchpoint, and monitors the variable in the ch..." alt="" coords="108,5,235,31"/>
<area shape="poly" title=" " alt="" coords="269,21,235,21,235,15,269,15"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="95,21,60,21,60,15,95,15"/>
</map>
</div>

</div>
</div>
<a id="a944ac1668f45b26a0da57b57ec159e78" name="a944ac1668f45b26a0da57b57ec159e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a944ac1668f45b26a0da57b57ec159e78">&#9670;&#160;</a></span>watchVariable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Debugger::watchVariable </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>runtimeAddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main loop that applies the hardware watchpoint and logs variable accesses. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>PID of the traced child process. </td></tr>
    <tr><td class="paramname">runtimeAddress</td><td>Runtime memory address of the watched variable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="debugger_8cpp_source.html#l00116">116</a> of file <a class="el" href="debugger_8cpp_source.html">debugger.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>                                                                       {</div>
<div class="line"><span class="lineno">  117</span>    uint64_t lastValue = 0;</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  119</span>        lastValue = <a class="code hl_function" href="memory__utils_8cpp.html#a23d8272a733098323a9e47d6cc07c37d">readProcessMemory</a>(pid, runtimeAddress, <a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>);</div>
<div class="line"><span class="lineno">  120</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"><span class="lineno">  121</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Initial read failed: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  122</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    std::cerr &lt;&lt; <a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a> &lt;&lt; <span class="stringliteral">&quot; initial=&quot;</span> &lt;&lt; lastValue &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_function" href="classDebugger.html#ac7d0423cddbb4b630749e6b13c4c1ed5">setHardwareWatchpoint</a>(pid, runtimeAddress);</div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_function" href="debugger_8cpp.html#a508830d991569eaf3d8f36366ad68092">clearDebugStatus</a>(pid);</div>
<div class="line"><span class="lineno">  129</span>    <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_CONT, pid, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ptrace(PTRACE_CONT) failed to start watch loop&quot;</span>);</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">if</span> (waitpid(pid, &amp;status, 0) == -1) {</div>
<div class="line"><span class="lineno">  134</span>            <span class="keywordflow">throw</span> std::runtime_error(std::string(<span class="stringliteral">&quot;waitpid failed: &quot;</span>) + std::strerror(errno));</div>
<div class="line"><span class="lineno">  135</span>        }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">if</span> (WIFEXITED(status)) {</div>
<div class="line"><span class="lineno">  138</span>            std::cerr &lt;&lt; <span class="stringliteral">&quot;Child exited (&quot;</span> &lt;&lt; WEXITSTATUS(status) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><span class="lineno">  139</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  140</span>        }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        <span class="keywordflow">if</span> (WIFSTOPPED(status)) {</div>
<div class="line"><span class="lineno">  143</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> sig = WSTOPSIG(status);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>            <span class="keywordflow">if</span> (sig == SIGTRAP) {</div>
<div class="line"><span class="lineno">  146</span>                errno = 0;</div>
<div class="line"><span class="lineno">  147</span>                <span class="keywordtype">long</span> dr6 = ptrace(PTRACE_PEEKUSER, pid, <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(offsetof(user, u_debugreg[6])), <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  148</span>                <span class="keywordflow">if</span> (dr6 == -1 &amp;&amp; errno != 0) {</div>
<div class="line"><span class="lineno">  149</span>                    std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning: failed to read DR6: &quot;</span> &lt;&lt; std::strerror(errno) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  150</span>                }</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>                <span class="keywordflow">if</span> ( (dr6 &amp; 0x1) != 0 ) {</div>
<div class="line"><span class="lineno">  153</span>                    uint64_t currentValue = 0;</div>
<div class="line"><span class="lineno">  154</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  155</span>                        currentValue = <a class="code hl_function" href="memory__utils_8cpp.html#a23d8272a733098323a9e47d6cc07c37d">readProcessMemory</a>(pid, runtimeAddress, <a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>);</div>
<div class="line"><span class="lineno">  156</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"><span class="lineno">  157</span>                        std::cerr &lt;&lt; <span class="stringliteral">&quot;Read during trap failed: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  158</span>                        <a class="code hl_function" href="debugger_8cpp.html#a508830d991569eaf3d8f36366ad68092">clearDebugStatus</a>(pid);</div>
<div class="line"><span class="lineno">  159</span>                        <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_CONT, pid, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ptrace(PTRACE_CONT) failed after failed read&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  161</span>                    }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>                    <span class="keywordflow">if</span> (currentValue != lastValue) {</div>
<div class="line"><span class="lineno">  164</span>                        std::cout &lt;&lt; <a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a> &lt;&lt; <span class="stringliteral">&quot;    write    &quot;</span> &lt;&lt; lastValue &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; currentValue &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  165</span>                        lastValue = currentValue;</div>
<div class="line"><span class="lineno">  166</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  167</span>                        std::cout &lt;&lt; <a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a> &lt;&lt; <span class="stringliteral">&quot;    read     &quot;</span> &lt;&lt; currentValue &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  168</span>                    }</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>                    <a class="code hl_function" href="debugger_8cpp.html#a508830d991569eaf3d8f36366ad68092">clearDebugStatus</a>(pid);</div>
<div class="line"><span class="lineno">  171</span>                    <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_CONT, pid, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ptrace(PTRACE_CONT) failed after trap handling&quot;</span>);</div>
<div class="line"><span class="lineno">  172</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  173</span>                }</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>                <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_CONT, pid, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ptrace(PTRACE_CONT) failed for non-DR0 SIGTRAP&quot;</span>);</div>
<div class="line"><span class="lineno">  176</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  177</span>            }</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  180</span>                uint64_t currentValue = <a class="code hl_function" href="memory__utils_8cpp.html#a23d8272a733098323a9e47d6cc07c37d">readProcessMemory</a>(pid, runtimeAddress, <a class="code hl_variable" href="classDebugger.html#aab84d2d21b212acbc00e644760140f4b">varSize</a>);</div>
<div class="line"><span class="lineno">  181</span>                <span class="keywordflow">if</span> (currentValue != lastValue) {</div>
<div class="line"><span class="lineno">  182</span>                    std::cout &lt;&lt; <a class="code hl_variable" href="classDebugger.html#ab58b15d3b221c0d3abd9ec8fc60f466d">varName</a> &lt;&lt; <span class="stringliteral">&quot;    write    &quot;</span> &lt;&lt; lastValue &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; currentValue &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  183</span>                    lastValue = currentValue;</div>
<div class="line"><span class="lineno">  184</span>                }</div>
<div class="line"><span class="lineno">  185</span>            } <span class="keywordflow">catch</span> (...) {}</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>            <a class="code hl_function" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04">ptraceChecked</a>(PTRACE_CONT, pid, <span class="keyword">nullptr</span>, <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(sig)),</div>
<div class="line"><span class="lineno">  188</span>                          <span class="stringliteral">&quot;ptrace(PTRACE_CONT) failed when forwarding signal&quot;</span>);</div>
<div class="line"><span class="lineno">  189</span>        }</div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span>}</div>
<div class="ttc" id="aclassDebugger_html_ac7d0423cddbb4b630749e6b13c4c1ed5"><div class="ttname"><a href="classDebugger.html#ac7d0423cddbb4b630749e6b13c4c1ed5">Debugger::setHardwareWatchpoint</a></div><div class="ttdeci">void setHardwareWatchpoint(pid_t pid, uintptr_t runtimeAddress) const</div><div class="ttdoc">Installs a hardware watchpoint using debug registers DR0–DR7.</div><div class="ttdef"><b>Definition</b> <a href="debugger_8cpp_source.html#l00090">debugger.cpp:90</a></div></div>
<div class="ttc" id="adebugger_8cpp_html_a508830d991569eaf3d8f36366ad68092"><div class="ttname"><a href="debugger_8cpp.html#a508830d991569eaf3d8f36366ad68092">clearDebugStatus</a></div><div class="ttdeci">void clearDebugStatus(pid_t pid)</div><div class="ttdef"><b>Definition</b> <a href="debugger_8cpp_source.html#l00109">debugger.cpp:109</a></div></div>
<div class="ttc" id="amemory__utils_8cpp_html_a23d8272a733098323a9e47d6cc07c37d"><div class="ttname"><a href="memory__utils_8cpp.html#a23d8272a733098323a9e47d6cc07c37d">readProcessMemory</a></div><div class="ttdeci">uint64_t readProcessMemory(const pid_t &amp;pid, const uintptr_t &amp;addr, const size_t &amp;size)</div><div class="ttdoc">Reads memory from a target process at a specific address.</div><div class="ttdef"><b>Definition</b> <a href="memory__utils_8cpp_source.html#l00034">memory_utils.cpp:34</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classDebugger_a944ac1668f45b26a0da57b57ec159e78_cgraph.png" border="0" usemap="#aclassDebugger_a944ac1668f45b26a0da57b57ec159e78_cgraph" alt=""/></div>
<map name="aclassDebugger_a944ac1668f45b26a0da57b57ec159e78_cgraph" id="aclassDebugger_a944ac1668f45b26a0da57b57ec159e78_cgraph">
<area shape="rect" title="Main loop that applies the hardware watchpoint and logs variable accesses." alt="" coords="5,81,212,107"/>
<area shape="rect" href="debugger_8cpp.html#a508830d991569eaf3d8f36366ad68092" title=" " alt="" coords="320,5,471,31"/>
<area shape="poly" title=" " alt="" coords="150,79,259,47,324,31,325,36,261,53,152,84"/>
<area shape="rect" href="debugger_8cpp.html#a026bafbd79531068f563be4582a62a04" title=" " alt="" coords="579,56,705,81"/>
<area shape="poly" title=" " alt="" coords="212,86,565,70,565,75,212,92"/>
<area shape="rect" href="memory__utils_8cpp.html#a23d8272a733098323a9e47d6cc07c37d" title="Reads memory from a target process at a specific address." alt="" coords="316,107,475,132"/>
<area shape="poly" title=" " alt="" coords="212,100,303,109,302,114,212,106"/>
<area shape="rect" href="classDebugger.html#ac7d0423cddbb4b630749e6b13c4c1ed5" title="Installs a hardware watchpoint using debug registers DR0–DR7." alt="" coords="260,156,531,181"/>
<area shape="poly" title=" " alt="" coords="144,104,261,142,299,151,298,156,259,147,142,109"/>
<area shape="poly" title=" " alt="" coords="459,28,567,51,566,56,458,33"/>
<area shape="poly" title=" " alt="" coords="495,153,530,142,576,117,614,89,617,93,579,122,532,147,496,159"/>
<area shape="rect" href="debugger_8cpp.html#a66d4e2440757917d3870682ce5495082" title=" " alt="" coords="587,156,697,181"/>
<area shape="poly" title=" " alt="" coords="531,166,573,166,573,171,531,171"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classDebugger_a944ac1668f45b26a0da57b57ec159e78_icgraph.png" border="0" usemap="#aclassDebugger_a944ac1668f45b26a0da57b57ec159e78_icgraph" alt=""/></div>
<map name="aclassDebugger_a944ac1668f45b26a0da57b57ec159e78_icgraph" id="aclassDebugger_a944ac1668f45b26a0da57b57ec159e78_icgraph">
<area shape="rect" title="Main loop that applies the hardware watchpoint and logs variable accesses." alt="" coords="283,5,489,31"/>
<area shape="rect" href="classDebugger.html#a0fb68979aeda450247b147fc2d3cce33" title="Forks and execs the target process, sets the hardware watchpoint, and monitors the variable in the ch..." alt="" coords="108,5,235,31"/>
<area shape="poly" title=" " alt="" coords="269,21,235,21,235,15,269,15"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="95,21,60,21,60,15,95,15"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5a5780226919af2ff430898ad95aabf9" name="a5a5780226919af2ff430898ad95aabf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a5780226919af2ff430898ad95aabf9">&#9670;&#160;</a></span>execArgs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char** Debugger::execArgs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Optional exec arguments. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00071">71</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>

</div>
</div>
<a id="a91d31ec968daa2d5c298b98a0f242559" name="a91d31ec968daa2d5c298b98a0f242559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91d31ec968daa2d5c298b98a0f242559">&#9670;&#160;</a></span>programPath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Debugger::programPath</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Path to the target executable. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00067">67</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>

</div>
</div>
<a id="ad83c26bb3aec8a3feffb8cd5c7561020" name="ad83c26bb3aec8a3feffb8cd5c7561020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83c26bb3aec8a3feffb8cd5c7561020">&#9670;&#160;</a></span>symbolOffset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t Debugger::symbolOffset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ELF symbol offset. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00069">69</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>

</div>
</div>
<a id="ab58b15d3b221c0d3abd9ec8fc60f466d" name="ab58b15d3b221c0d3abd9ec8fc60f466d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab58b15d3b221c0d3abd9ec8fc60f466d">&#9670;&#160;</a></span>varName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Debugger::varName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of the variable to watch. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00068">68</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>

</div>
</div>
<a id="aab84d2d21b212acbc00e644760140f4b" name="aab84d2d21b212acbc00e644760140f4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab84d2d21b212acbc00e644760140f4b">&#9670;&#160;</a></span>varSize</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Debugger::varSize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Variable size in bytes. </p>

<p class="definition">Definition at line <a class="el" href="debugger_8hpp_source.html#l00070">70</a> of file <a class="el" href="debugger_8hpp_source.html">debugger.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="debugger_8hpp_source.html">debugger.hpp</a></li>
<li>src/<a class="el" href="debugger_8cpp_source.html">debugger.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 1 2025 17:02:14 for gwatch by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
